# æƒé™æ¨¡å¼æŒ‡å—

> æ§åˆ¶AIOSä»£ç†å¯¹æ‚¨ç³»ç»Ÿçš„è‡ªä¸»æƒã€‚

---

## æ¦‚è¿°

æƒé™æ¨¡å¼è®©æ‚¨æ§åˆ¶AIOSä»£ç†æ‹¥æœ‰çš„è‡ªä¸»æƒçº§åˆ«ã€‚æ— è®ºæ‚¨æ˜¯æ¢ç´¢æ–°ä»£ç åº“è¿˜æ˜¯è¿è¡Œå®Œå…¨è‡ªä¸»çš„æ„å»ºï¼Œéƒ½æœ‰é€‚åˆæ‚¨å·¥ä½œæµçš„æ¨¡å¼ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” æ¢ç´¢         â”‚  âš ï¸ è¯¢é—®         â”‚  âš¡ è‡ªåŠ¨           â”‚
â”‚  å®‰å…¨æµè§ˆ        â”‚  ç¡®è®¤æ›´æ”¹        â”‚  å®Œå…¨è‡ªä¸»         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¯»å–: âœ…        â”‚  è¯»å–: âœ…        â”‚  è¯»å–: âœ…         â”‚
â”‚  å†™å…¥: âŒ        â”‚  å†™å…¥: âš ï¸ç¡®è®¤    â”‚  å†™å…¥: âœ…         â”‚
â”‚  æ‰§è¡Œ: âŒ        â”‚  æ‰§è¡Œ: âš ï¸ç¡®è®¤    â”‚  æ‰§è¡Œ: âœ…         â”‚
â”‚  åˆ é™¤: âŒ        â”‚  åˆ é™¤: âš ï¸ç¡®è®¤    â”‚  åˆ é™¤: âœ…         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¿«é€Ÿå¼€å§‹

```bash
# æ£€æŸ¥å½“å‰æ¨¡å¼
*mode

# åˆ‡æ¢åˆ°æ¢ç´¢æ¨¡å¼ï¼ˆå®‰å…¨ï¼‰
*mode explore

# åˆ‡æ¢åˆ°è¯¢é—®æ¨¡å¼ï¼ˆå‡è¡¡-é»˜è®¤ï¼‰
*mode ask

# åˆ‡æ¢åˆ°è‡ªåŠ¨æ¨¡å¼ï¼ˆç‹‚é‡ï¼‰
*mode auto
# æˆ–
*yolo
```

---

## æ¨¡å¼è¯´æ˜

### ğŸ” æ¢ç´¢æ¨¡å¼

**æœ€é€‚åˆ:** é¦–æ¬¡æ¢ç´¢ã€å­¦ä¹ ä»£ç åº“ã€åªè¯»å®¡è®¡

```
*mode explore
```

åœ¨æ¢ç´¢æ¨¡å¼ä¸­:

- âœ… è¯»å–ä»»ä½•æ–‡ä»¶
- âœ… æœç´¢ä»£ç åº“
- âœ… è¿è¡Œåªè¯»å‘½ä»¤ï¼ˆgit statusã€lsç­‰ï¼‰
- âŒ æ— æ³•å†™å…¥æˆ–ç¼–è¾‘æ–‡ä»¶
- âŒ æ— æ³•è¿è¡Œæ½œåœ¨ç ´åæ€§å‘½ä»¤
- âŒ æ— æ³•æ‰§è¡Œæ„å»º/éƒ¨ç½²æ“ä½œ

**ç¤ºä¾‹é˜»æ­¢çš„æ“ä½œ:**

- `Write` / `Edit` å·¥å…·
- `git push`, `git commit`
- `npm install`
- `rm`, `mv`, `mkdir`

---

### âš ï¸ è¯¢é—®æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

**æœ€é€‚åˆ:** æ—¥å¸¸å¼€å‘ã€å®‰å…¨æ€§å’Œç”Ÿäº§åŠ›çš„å¹³è¡¡

```
*mode ask
```

åœ¨è¯¢é—®æ¨¡å¼ä¸­:

- âœ… è¯»å–ä»»ä½•æ–‡ä»¶
- âš ï¸ å†™å…¥æ“ä½œéœ€è¦ç¡®è®¤
- âš ï¸ æ‰§è¡Œæ“ä½œéœ€è¦ç¡®è®¤
- âš ï¸ ç ´åæ€§æ“ä½œéœ€è¦æ˜ç¡®æ‰¹å‡†

**ç¡®è®¤æµç¨‹:**

```
âš ï¸ éœ€è¦ç¡®è®¤

æ“ä½œ: å†™å…¥
å·¥å…·: ç¼–è¾‘

æ–‡ä»¶: `src/components/Button.tsx`

[ç»§ç»­] [è·³è¿‡] [åˆ‡æ¢åˆ°è‡ªåŠ¨]
```

---

### âš¡ è‡ªåŠ¨æ¨¡å¼

**æœ€é€‚åˆ:** é«˜çº§ç”¨æˆ·ã€è‡ªä¸»æ„å»ºã€ä¿¡ä»»çš„å·¥ä½œæµ

```
*mode auto
# æˆ–
*yolo
```

åœ¨è‡ªåŠ¨æ¨¡å¼ä¸­:

- âœ… å®Œæ•´è¯»å–è®¿é—®æƒé™
- âœ… å®Œæ•´å†™å…¥è®¿é—®æƒé™
- âœ… å®Œæ•´æ‰§è¡Œè®¿é—®æƒé™
- âœ… æ— éœ€ç¡®è®¤

**è­¦å‘Š:** è°¨æ…ä½¿ç”¨ã€‚ä»£ç†å¯ä»¥ä¿®æ”¹å’Œåˆ é™¤æ–‡ä»¶è€Œä¸è¯¢é—®ã€‚

---

## æ¨¡å¼æŒ‡ç¤ºå™¨

æ‚¨çš„å½“å‰æ¨¡å¼å§‹ç»ˆåœ¨ä»£ç†é—®å€™è¯­ä¸­å¯è§:

```
ğŸ›ï¸ Aria (æ¶æ„å¸ˆ) å·²å‡†å¤‡å¥½ï¼[âš ï¸ è¯¢é—®]

å¿«é€Ÿå‘½ä»¤:
...
```

å¾½ç« æ˜¾ç¤º:

- `[ğŸ” æ¢ç´¢]` - åªè¯»æ¨¡å¼
- `[âš ï¸ è¯¢é—®]` - ç¡®è®¤æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- `[âš¡ è‡ªåŠ¨]` - å®Œå…¨è‡ªä¸»æ¨¡å¼

---

## é…ç½®

æ¨¡å¼æŒä¹…åŒ–åœ¨`.aios/config.yaml`:

```yaml
permissions:
  mode: ask # explore | ask | auto
```

---

## æ“ä½œåˆ†ç±»

ç³»ç»Ÿå°†æ“ä½œåˆ†ä¸º4ç§ç±»å‹:

| ç±»å‹ | ç¤ºä¾‹ |
|------|------|
| **è¯»å–** | `Read`ã€`Glob`ã€`Grep`ã€`git status`ã€`ls` |
| **å†™å…¥** | `Write`ã€`Edit`ã€`mkdir`ã€`touch`ã€`git commit` |
| **æ‰§è¡Œ** | `npm install`ã€`npm run`ã€ä»»åŠ¡æ‰§è¡Œ |
| **åˆ é™¤** | `rm`ã€`git reset --hard`ã€`DROP TABLE` |

### å®‰å…¨å‘½ä»¤ï¼ˆå§‹ç»ˆå…è®¸ï¼‰

è¿™äº›å‘½ä»¤å³ä½¿åœ¨æ¢ç´¢æ¨¡å¼ä¸‹ä¹Ÿå§‹ç»ˆå…è®¸:

```bash
# Gitï¼ˆåªè¯»ï¼‰
git status, git log, git diff, git branch

# æ–‡ä»¶ç³»ç»Ÿï¼ˆåªè¯»ï¼‰
ls, pwd, cat, head, tail, wc, find, grep

# åŒ…ä¿¡æ¯
npm list, npm outdated, npm audit

# ç³»ç»Ÿä¿¡æ¯
node --version, npm --version, uname, whoami
```

### ç ´åæ€§å‘½ä»¤ï¼ˆé¢å¤–è°¨æ…ï¼‰

è¿™äº›è§¦å‘åˆ é™¤åˆ†ç±»ï¼Œå³ä½¿åœ¨è¯¢é—®æ¨¡å¼ä¸‹ä¹Ÿéœ€è¦æ˜ç¡®æ‰¹å‡†:

```bash
rm -rf
git reset --hard
git push --force
DROP TABLE
DELETE FROM
TRUNCATE
```

---

## ADEé›†æˆ

è‡ªä¸»å¼€å‘å¼•æ“(ADE)å°Šé‡æƒé™æ¨¡å¼:

| æ¨¡å¼ | ADEè¡Œä¸º |
|------|---------|
| **æ¢ç´¢** | ä»…è§„åˆ’ï¼Œæ— æ‰§è¡Œ |
| **è¯¢é—®** | æ‰¹é‡æ“ä½œå¾…æ‰¹å‡† |
| **è‡ªåŠ¨** | å®Œå…¨è‡ªä¸»æ‰§è¡Œ |

### è¯¢é—®æ¨¡å¼ä¸­çš„æ‰¹é‡æ‰¹å‡†

è¿è¡Œè‡ªä¸»å·¥ä½œæµæ—¶ï¼Œæ“ä½œè¢«åˆ†ç»„:

```
âš ï¸ æ‰¹é‡ç¡®è®¤

ä»¥ä¸‹5ä¸ªæ“ä½œå°†è¢«æ‰§è¡Œ:
- å†™å…¥: åˆ›å»º src/components/NewFeature.tsx
- å†™å…¥: æ›´æ–° src/index.ts
- æ‰§è¡Œ: npm install lodash
- å†™å…¥: æ·»åŠ  tests/newFeature.test.ts
- æ‰§è¡Œ: npm test

[å…¨éƒ¨æ‰¹å‡†] [é€ä¸ªå®¡æŸ¥] [å–æ¶ˆ]
```

---

## æœ€ä½³å®è·µ

### å¯¹äºæ–°ç”¨æˆ·

1. ä»`*mode explore`å¼€å§‹å®‰å…¨æµè§ˆ
2. å‡†å¤‡å¥½è¿›è¡Œæ›´æ”¹æ—¶åˆ‡æ¢åˆ°`*mode ask`
3. ä»…åœ¨ç¡®ä¿¡æ—¶ä½¿ç”¨`*mode auto`

### å¯¹äºCI/CD

åœ¨è‡ªåŠ¨åŒ–ä¸­è®¾ç½®æ¨¡å¼:

```yaml
# .github/workflows/aios.yml
- name: è¿è¡ŒAIOS
  run: |
    echo "permissions:\n  mode: auto" > .aios/config.yaml
    aios run build
```

### å¯¹äºå›¢é˜Ÿ

- åœ¨å…±äº«ç¯å¢ƒä¸­é»˜è®¤ä½¿ç”¨`ask`æ¨¡å¼
- åœ¨ä»£ç å®¡æŸ¥ä¸­ä½¿ç”¨`explore`
- ä¸ºæŒ‡å®šçš„è‡ªåŠ¨åŒ–å¸æˆ·ä¿ç•™`auto`

---

## æ•…éšœæ’é™¤

### "åœ¨æ¢ç´¢æ¨¡å¼ä¸­æ“ä½œè¢«é˜»æ­¢"

åˆ‡æ¢åˆ°é™åˆ¶è¾ƒå°‘çš„æ¨¡å¼:

```
*mode ask
```

### æ¨¡å¼ä¸æŒä¹…åŒ–

æ£€æŸ¥`.aios/config.yaml`å­˜åœ¨ä¸”å¯å†™:

```bash
ls -la .aios/config.yaml
```

### ç¡®è®¤è¿‡äºé¢‘ç¹

åˆ‡æ¢åˆ°è‡ªåŠ¨æ¨¡å¼:

```
*mode auto
```

æˆ–åœ¨ADEå·¥ä½œæµä¸­ä½¿ç”¨æ‰¹é‡æ‰¹å‡†ã€‚

---

## APIå‚è€ƒ

```javascript
const { PermissionMode, OperationGuard } = require('./.aios-core/core/permissions');

// åŠ è½½å½“å‰æ¨¡å¼
const mode = new PermissionMode();
await mode.load();
console.log(mode.currentMode); // 'ask'
console.log(mode.getBadge()); // '[âš ï¸ è¯¢é—®]'

// æ›´æ”¹æ¨¡å¼
await mode.setMode('auto');

// æ£€æŸ¥æ“ä½œ
const guard = new OperationGuard(mode);
const result = await guard.guard('Bash', { command: 'rm -rf node_modules' });
// { proceed: false, needsConfirmation: true, operation: 'delete', ... }
```

---

_æƒé™æ¨¡å¼ - å— [Craft Agents OSS](https://github.com/lukilabs/craft-agents-oss) å¯å‘_
