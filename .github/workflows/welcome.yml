# Welcome New Contributors Workflow
# Automatically welcomes first-time contributors to AIOS
#
# Reference: https://github.com/actions/first-interaction
# Story: GHIM-001 - GitHub Issue Management

name: Welcome New Contributors

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

permissions:
  issues: write
  pull-requests: write

jobs:
  welcome:
    runs-on: ubuntu-latest
    steps:
      - name: Welcome first-time contributors
        uses: actions/first-interaction@v1
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          issue-message: |
            Welcome to **aios-core**! Thanks for opening your first issue.

            **What happens next?**
            - A maintainer will triage this and add appropriate labels
            - We'll respond as soon as possible
            - Feel free to join [Community Discussions](https://github.com/SynkraAI/aios-core/discussions)

            **Helpful Resources:**
            - [Contributing Guide](https://github.com/SynkraAI/aios-core/blob/main/CONTRIBUTING.md)
            - [Documentation](https://github.com/SynkraAI/aios-core/tree/main/docs)

            **Looking to contribute?** Check issues labeled `community: good first issue`.

          pr-message: |
            Welcome to **aios-core**! Thanks for your first pull request.

            **What happens next?**
            1. Automated checks will run on your PR
            2. A maintainer will review your changes
            3. Once approved, we'll merge your contribution!

            **PR Checklist:**
            - [ ] Tests pass (`npm test`)
            - [ ] Linting passes (`npm run lint`)
            - [ ] Commit messages follow [Conventional Commits](https://www.conventionalcommits.org/)

            Thanks for contributing!

      - name: Add triage label to new issues
        if: github.event_name == 'issues'
        uses: actions/github-script@v7
        with:
          script: |
            const labels = await github.rest.issues.listLabelsOnIssue({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number
            });

            const hasTriageLabel = labels.data.some(label =>
              label.name === 'status: needs-triage'
            );

            if (!hasTriageLabel) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: ['status: needs-triage']
              });
            }
